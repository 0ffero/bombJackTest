function generateAnimFrames(){selectedSprite="jack",scene.anims.create({key:"left",frames:scene.anims.generateFrameNumbers(selectedSprite,{start:0,end:3}),frameRate:10,repeat:-1}),scene.anims.create({key:"turn",frames:[{key:selectedSprite,frame:4}],frameRate:20}),scene.anims.create({key:"right",frames:scene.anims.generateFrameNumbers(selectedSprite,{start:5,end:8}),frameRate:10,repeat:-1}),scene.anims.create({key:"flyUp",frames:[{key:selectedSprite,frame:9}],frameRate:20}),scene.anims.create({key:"flyDown",frames:[{key:selectedSprite,frame:10}],frameRate:20}),scene.anims.create({key:"flyDownLeft",frames:[{key:selectedSprite,frame:11}],frameRate:20}),scene.anims.create({key:"flyDownRight",frames:[{key:selectedSprite,frame:12}],frameRate:20}),scene.anims.create({key:"flyUpLeft",frames:[{key:selectedSprite,frame:13}],frameRate:20}),scene.anims.create({key:"flyUpRight",frames:[{key:selectedSprite,frame:14}],frameRate:20}),scene.anims.create({key:"tumble",frames:scene.anims.generateFrameNumbers(selectedSprite,{start:15,end:18}),frameRate:8,repeat:-1}),scene.anims.create({key:"hitFloorAfterDeath",frames:scene.anims.generateFrameNumbers(selectedSprite,{start:19,end:22}),frameRate:4}),selectedSprite="bomb",scene.anims.create({key:"normal",frames:[{key:selectedSprite,frame:0}],frameRate:4}),scene.anims.create({key:"exploding",frames:scene.anims.generateFrameNumbers(selectedSprite,{start:1,end:2}),frameRate:10,repeat:-1}),scene.anims.create({key:"collected",frames:scene.anims.generateFrameNumbers(selectedSprite,{start:3,end:4}),frameRate:10,repeat:-1}),selectedSprite="enemyBird",scene.anims.create({key:"flyLeft",frames:scene.anims.generateFrameNumbers(selectedSprite,{start:0,end:3}),frameRate:4,yoyo:!0,repeat:-1}),scene.anims.create({key:"turning",frames:scene.anims.generateFrameNumbers(selectedSprite,{start:4,end:6}),frameRate:4,yoyo:!1,repeat:-1}),scene.anims.create({key:"flyRight",frames:scene.anims.generateFrameNumbers(selectedSprite,{start:7,end:10}),frameRate:4,yoyo:!0,repeat:-1}),selectedSprite="enemyRobot",scene.anims.create({key:"robotTurning",frames:scene.anims.generateFrameNumbers(selectedSprite,{start:0,end:1}),frameRate:3,repeat:-1}),scene.anims.create({key:"robotWalkRight",frames:scene.anims.generateFrameNumbers(selectedSprite,{start:2,end:4}),frameRate:4,repeat:-1}),scene.anims.create({key:"robotWalkLeft",frames:scene.anims.generateFrameNumbers(selectedSprite,{start:5,end:7}),frameRate:3,repeat:-1}),selectedSprite="enemyRobot2",scene.anims.create({key:"robotTurning2",frames:scene.anims.generateFrameNumbers(selectedSprite,{start:0,end:1}),frameRate:3,repeat:-1}),scene.anims.create({key:"robotWalkRight2",frames:scene.anims.generateFrameNumbers(selectedSprite,{start:2,end:5}),frameRate:4,repeat:-1}),scene.anims.create({key:"robotWalkLeft2",frames:scene.anims.generateFrameNumbers(selectedSprite,{start:6,end:9}),frameRate:3,repeat:-1}),selectedSprite="robotEvolved",scene.anims.create({key:"robotEvolved",frames:scene.anims.generateFrameNumbers(selectedSprite,{start:0,end:6}),frameRate:15,repeat:-1}),scene.anims.create({key:"robotEvolved2",frames:scene.anims.generateFrameNumbers(selectedSprite,{start:7,end:15}),frameRate:15,repeat:-1}),scene.anims.create({key:"robotEvolved3",frames:scene.anims.generateFrameNumbers(selectedSprite,{start:16,end:21}),frameRate:15,repeat:-1}),selectedSprite="robotHitFloor",scene.anims.create({key:"robotEvolving",frames:scene.anims.generateFrameNumbers(selectedSprite,{start:0,end:3}),frameRate:8}),scene.anims.create({key:"otherEvolving",frames:scene.anims.generateFrameNumbers(selectedSprite,{start:4,end:7}),frameRate:8}),selectedSprite="collectables",scene.anims.create({key:"bonus",frames:scene.anims.generateFrameNumbers(selectedSprite,{start:0,end:3}),frameRate:10,repeat:-1}),scene.anims.create({key:"extraLife",frames:scene.anims.generateFrameNumbers(selectedSprite,{start:4,end:7}),frameRate:10,repeat:-1}),scene.anims.create({key:"special",frames:scene.anims.generateFrameNumbers(selectedSprite,{start:8,end:11}),frameRate:10,repeat:-1}),scene.anims.create({key:"powerBallBlue",frames:[{key:selectedSprite,frame:12}],frameRate:1}),scene.anims.create({key:"powerBallRed",frames:[{key:selectedSprite,frame:13}],frameRate:1}),scene.anims.create({key:"powerBallPurple",frames:[{key:selectedSprite,frame:14}],frameRate:1}),scene.anims.create({key:"powerBallGreen",frames:[{key:selectedSprite,frame:15}],frameRate:1}),scene.anims.create({key:"powerBallTurquoise",frames:[{key:selectedSprite,frame:16}],frameRate:1}),scene.anims.create({key:"powerBallYellow",frames:[{key:selectedSprite,frame:17}],frameRate:1}),scene.anims.create({key:"powerBallGrey",frames:[{key:selectedSprite,frame:18}],frameRate:1})}function animateBombJack(e=0){switch(vars.isPaused=!0,animTime=333,e){case 0:case 6:selectedSprite="left";break;case 1:case 7:selectedSprite="right";break;case 2:case 4:case 8:case 10:selectedSprite="flyUp";break;case 3:case 5:case 9:case 11:selectedSprite="turn"}e<12&&(player.anims.play(selectedSprite,!0),setTimeout((function(){animateBombJack(e+1)}),animTime))}function animateLogo(){switch(swapOriginal=vars.blues,swapNew=vars.colours.blues,blue1=swapNew[0],blue2=swapNew[1],blue3=swapNew[2],canvas=document.getElementById("animMainScreen"),ctx=canvas.getContext("2d"),imageDataCTX=ctx.getImageData(0,0,w,h),imageData=imageDataCTX.data,vars.blues.currentOffset){case 0:colourMoves=[swapNew[0],swapNew[1],swapNew[2]];break;case 1:colourMoves=[swapNew[2],swapNew[0],swapNew[1]];break;case 2:colourMoves=[swapNew[1],swapNew[2],swapNew[0]]}for(2==vars.blues.currentOffset?vars.blues.currentOffset=0:vars.blues.currentOffset++,colSetCount=0;colSetCount<vars.colours.blues.length;colSetCount++)for(i=0;i<swapOriginal["blue"+(colSetCount+1)].length;i++)position=swapOriginal["blue"+(colSetCount+1)][i],imageData[position]=colourMoves[colSetCount][0],imageData[position+1]=colourMoves[colSetCount][1],imageData[position+2]=colourMoves[colSetCount][2];imageDataCTX.data=imageData,ctx.putImageData(imageDataCTX,0,0)}function animateStartLogo(){playBGMusic(),scene.physics.pause(),startLeft.visible=!0,startLeft.setDepth(1),startRight.visible=!0,startRight.setDepth(1),scene.visible=!1,vars.levelIntroVisible=!0,tweenOffset.totalProgress=0,tweenOffset.restart()}function hideMSLines(e=!0,s=0){if(!1===vars.gameStarted){let a=[];childNames=0===s?"msLine":"msLine"+s,messages.children.each((function(e){e.name===childNames&&a.push(e)}));let t=0;fadeInterval=setInterval((function(){t<a.length?(a[t].visible=!0!==e,t++):clearInterval(fadeInterval)}),1e3/60*1)}}function setUpAnimatedLogo(){let e=scene.textures.getFrame("mainScreen",0),s=document.createElement("canvas");w=s.width=vars.blues.cutWidth,h=s.height=vars.blues.cutHeight,s.id="animMainScreen",s.style.display="block",s.style.zIndex=10;let a=s.getContext("2d");a.clearRect(0,0,w,h),a.drawImage(e.source.image,vars.blues.cutPadLeft,vars.blues.cutPadTop,w,h,0,0,w,h),document.body.appendChild(s);let t=a.getImageData(0,0,w,h).data,o=vars.colours.blues;for(i=0;i<t.length-4;i+=4)for(colSet=0;colSet<o.length;colSet++)t[i]==o[colSet][0]&&t[i+1]==o[colSet][1]&&t[i+2]==o[colSet][2]&&vars.blues["blue"+(colSet+1)].push(i)}function showStartBanner(){playBGMusic(),vars.levelIntroVisible=!0,player.visible=!1,setTimeout((function(){vars.isPaused=!1}),2050),tweenOffset=scene.tweens.addCounter({from:0,to:400,ease:"Power2",duration:2e3,yoyo:!1})}var platforms,musicPlaying=!1,playMusic=!1,mns=musicAndSfx={sfx_jump:{init:!1,id:null,audio:null,loaded:!1,loop:!1,volume:.2,src:["assets/sounds/jump.ogg"]},sfx_collectLitBomb:{init:!1,id:null,audio:null,loaded:!1,loop:!1,volume:.2,src:["assets/sounds/collectLitBomb.ogg"]},sfx_collectNormalBomb:{init:!1,id:null,audio:null,loaded:!1,loop:!1,volume:.2,src:["assets/sounds/collectNormalBomb.ogg"]},sfx_levelComplete:{init:!1,id:null,audio:null,loaded:!1,loop:!1,volume:.2,src:["assets/sounds/levelComplete.ogg"]},sfx_powerBallMoving:{init:!1,id:null,audio:null,loaded:!1,loop:!0,volume:.1,src:["assets/sounds/powerBallMoving.ogg"]},sfx_powerBallCollected:{init:!1,id:null,audio:null,loaded:!1,loop:!1,volume:.1,src:["assets/sounds/powerBallCollected.ogg"]},sfx_touchedAnEnemy:{init:!1,id:null,audio:null,loaded:!1,loop:!1,volume:.2,src:["assets/sounds/touchedAnEnemy.ogg"]},mzk_bonusScreen:{init:!1,id:null,audio:null,loaded:!1,loop:!1,volume:.1,src:["assets/sounds/bonusScoreScreen.ogg"]},mzk_BGM1:{init:!1,id:null,audio:null,loaded:!1,loop:!0,volume:.1,src:["assets/sounds/BGM1.ogg"]},mzk_BGM2:{init:!1,id:null,audio:null,loaded:!1,loop:!0,volume:.1,src:["assets/sounds/BGM2.ogg"]},mzk_BGM3:{init:!1,id:null,audio:null,loaded:!1,loop:!0,volume:.1,src:["assets/sounds/BGM3.ogg"]}};function buildVolumeGraphic(){if(vars.volumeGraphic.length>0){for(let e=0;e<vars.volumeGraphic.length;e++)vars.volumeGraphic[e].destroy();vars.volumeGraphic=[]}let e="";e=scene.add.image(769,361,"bSquare"),e.setOrigin(0,0),e.setScale(40,384),vars.volumeGraphic.push(e),currentVolume=10*Howler.volume();let s=52;e=scene.add.image(785,730,"alpha",vars.alpha["-"]),vars.volumeGraphic.push(e);for(let a=10;a>0;a--){a==currentVolume&&(s=51),e=scene.add.image(785,730-32*a,"alpha",s),e.name="vol"+(a+1);let t=vars.volumeColours[currentVolume],o=t.h/360,r=t.s/100,i=t.l/100,l=Phaser.Display.Color.HSLToColor(o,r,i).color;e.setTint(l),vars.volumeGraphic.push(e)}e=scene.add.image(785,378,"alpha",vars.alpha["+"]),e.setDepth(10),vars.volumeGraphic.push(e),vars.vgVisible=!0,vars.volumeHide=vars.volumeHideMax}function disableSound(){0===Howler.volume()?Howler.volume(1):Howler.volume(0)}function musicEnable(){let e=!0;!0===vars.BGMEnabled?vars.BGMEnabled=!1:(vars.BGMEnabled=!0,e=!1),!0===vars.gameStarted&&pauseBGM(e)}function musicGetNextTrack(){3==vars.currentBGM?vars.currentBGM=1:vars.currentBGM++}function playBGMusic(){1==vars.BGMEnabled&&mns["mzk_BGM"+vars.currentBGM].audio.play()}function pauseBGM(e=!0){let s="mzk_BGM"+vars.currentBGM;!0===e?mns[s].audio.pause():mns[s].audio.play()}function soundLoader(){for(soundName in mns)sound=mns[soundName],src=sound.src,1==sound.loop?loop=!0:loop=!1,howl=new Howl({src:src,loop:loop,volume:sound.volume}),howl.id=sound.id=soundName,sound.audio=howl,howl.once("load",(function(){mnsID=this.id,mns[mnsID].loaded=!0}));waitForSoundsLoaded()}function soundVolume(e){let s=!1;"up"===e?Howler.volume()<1&&(Howler.volume(Math.round(10*(Howler.volume()+.1))/10),s=!0):Howler.volume()>0&&(Howler.volume(Math.round(10*(Howler.volume()-.1))/10),s=!0),!0===s&&(!0===vars.DEBUG&&console.log("Howler volume set to "+Howler.volume()),buildVolumeGraphic())}function stopAllMusic(){mns.mzk_BGM1.audio.stop(),mns.mzk_BGM2.audio.stop(),mns.mzk_BGM3.audio.stop(),mns.sfx_powerBallCollected.audio.stop(),mns.sfx_powerBallMoving.audio.stop()}function waitForSoundsLoaded(){for(soundName in loaded=counter=0,mns)1==mns[soundName].loaded?(loaded++,counter++):counter++;counter!=loaded?setTimeout((function(){waitForSoundsLoaded()}),500):console.log("%c♫ ~~~ All Sounds Loaded ~~~ ♫","font-size: 24px; background-color: black; color: red;")}class collectable{constructor(e){this.collectableSprite=e,this.spriteSheet="collectables",this.init()}getXYBasedOnPlayer(){this.x=Phaser.Math.Between(100,600),this.y=Phaser.Math.Between(200,300)}init(){this.getXYBasedOnPlayer(),this.collectable=collectables.create(this.x,this.y,this.spriteSheet),this.collectable.name=this.collectableSprite,"power"===this.collectableSprite?(this.collectable.anims.play("powerBallBlue"),vars.powerBallVisible=!0,pauseBGM(!0),mns.sfx_powerBallMoving.audio.play()):this.collectable.anims.play(this.collectableSprite),this.move()}move(){if("power"==this.collectableSprite)this.collectable.body.setAllowGravity(!1),this.collectable.body.setVelocity(200,200),this.collectable.body.setBounce(1,1);else{let e=~~(2*Math.random());0===e&&(e=-1),this.collectable.body.setVelocityX(100*e),this.collectable.body.setBounceX(1)}}}function collectbomb(e,s){s.disableBody(!0,!1),s.anims.play("collected",!0),mns.sfx_collectNormalBomb.audio.play(),setNextBomb(s),setTimeout((function(){s.disableBody(!0,!0)}),250),40==vars.extraLifeBombCount?(vars.extraLifeBombCount=0,spawnCollectable("E")):vars.extraLifeBombCount++,0===bombs.countActive(!0)&&(stopAllMusic(),vars.resetPowerBall(),scene.input.enabled=!1,scene.physics.pause(),vars.isPaused=!0,musicGetNextTrack(),mns.sfx_levelComplete.audio.play(),animateBombJack(),setTimeout((function(){vars.level+1>levels.mapCount?(vars.level=1,vars.completionCount++):vars.level++,vars.bombRun-1>20?timeOut=5e3:timeOut=0,timeOut>0&&showBonusScore(vars.bombRun),e.disableBody(!0,!0),setTimeout((function(){hideBonusScreen(),clearLevel(),stageText.setText("Stage: "+vars.completionCount+"/"+vars.level),drawLevel(bombs,platforms),e.enableBody(!0,400,400,!0,!0),animateStartLogo()}),timeOut)}),4e3))}function pickUpCollectable(e,s){let a=s.body.x,t=s.body.y;if(mns.sfx_collectNormalBomb.audio.play(),"power"==s.name){!0===vars.DEBUG&&console.log("Picked up powerball"),mns.sfx_powerBallMoving.audio.stop(),mns.sfx_powerBallCollected.audio.play(),s.disableBody(!0,!0),vars.pBCollected=!0,disableEnemies(!0);let o=0;switch(vars.powerBallColour){case 0:o=100;break;case 1:o=200;break;case 2:o=300;break;case 3:o=500;break;case 4:o=800;break;case 5:o=1e3;break;case 6:o=2e3}updateScore(a,t,o,!1,!1),vars.powerBallColour=0;let r=0;flashingEnemies=setTimeout((function(){if("undefined"!==flashingEnemies){var e=setInterval((function(){for(let e=0;e<vars.levelEnemies.length;e++)currentEnemy=vars.levelEnemies[e],!0===currentEnemy.enemy.getData("isAlive")&&(currentEnemy.visible=!0),vars.enemyFlashCount%2==0?(currentEnemy.enemy.anims.pause(),currentEnemy.enemy.setTexture("enemyCollectable",0)):currentEnemy.enemy.anims.resume(),vars.enemyFlashCount%3==0&&(currentEnemy.visible=!1);6==vars.enemyFlashCount&&(clearInterval(e),e=void 0,vars.powerBallVisible=!1,!0===currentEnemy.enemy.getData("isAlive")&&(currentEnemy.visible=!0),vars.enemyFlashCount=0),vars.enemyFlashCount++}),250,r);clearTimeout(flashingEnemies),flashingEnemies=void 0}}),4750),resetPowerBall=setTimeout((function(){vars.resetPowerBall(),disableEnemies(!1),mns.sfx_powerBallCollected.audio.stop(),pauseBGM(!1);let s=vars.levelEnemies;deadEnemiesCount=[0,0];let a=0;for(let t=0;t<s.length;t++)if(currentEnemy=s[t],!1===currentEnemy.alive){switch(currentEnemy.spriteType){case"enemyBird":deadEnemiesCount[0]++,newX=currentEnemy.initX,e.y>=400?newY=currentEnemy.initY:newY=vars.enemyPositions.y[vars.enemyPositions.y.length-1],currentEnemy.enemy.x=currentEnemy.moveToX=currentEnemy.x=newX,currentEnemy.enemy.y=currentEnemy.moveToY=currentEnemy.y=newY,currentEnemy.enemy.enableBody(!0,newX,newY,!0,!0);break;case"enemyRobot":deadEnemiesCount[1]++,newX=currentEnemy.initX,newY=currentEnemy.initY,resetInvisWalls()}currentEnemy.alive=!0,vars.pBCollected=!1}else"enemyRobot"===currentEnemy.spriteType&&!1===currentEnemy.enemy.getData("hasEvolved")&&a++;let t=1;if(vars.level>1&&(t+=1),t+(vars.levelEnemies.length-(t+deadEnemiesCount[1]))<t+1){for(let e=t;e<vars.levelEnemies.length;e++)vars.levelEnemies[e].enemy.destroy();vars.levelEnemies=vars.levelEnemies.slice(0,t),spawnRobot()}0===a&&spawnRobot(),clearTimeout(resetPowerBall),resetPowerBall=void 0}),7e3)}"bonus"==s.name&&(!0===vars.DEBUG&&console.log("Picked up bonus"),s.disableBody(!0,!0),updateScore(a,t,1e3,!1,!0),vars.bonusMultiplier<5?vars.bonusMultiplier++:vars.bonusMultiplier,vars.bonusMultiplierImg[1].setTexture("bonusMultipliers",vars.bonusMultiplier)),"extraLife"==s.name&&(!0===vars.DEBUG&&console.log("Extra Life Picked Up"),s.disableBody(!0,!0),updateScore(a,t,1e3,!1,!0),addLife()),"special"==s.name&&(!0===vars.DEBUG&&console.log("Special picked up - Gives you an extra credit and skips you to the next level"),!(vars.credits<3)||vars.credits++)}function spawnCollectable(e){switch(e){case"B":!0===vars.DEBUG&&console.log("Creating a bonus ball"),5!==vars.bonusMultiplier&&vars.levelCollectables.push(new collectable("bonus"));break;case"E":!0===vars.DEBUG&&console.log("Creating an extra life collectable"),vars.levelCollectables.push(new collectable("extraLife"));break;case"P":!0===vars.DEBUG&&console.log("Creating a power ball"),vars.levelCollectables.push(new collectable("power")),vars.powerBallVisible=!0;break;case"S":!0===vars.DEBUG&&console.log("Creating a special collectable"),vars.levelCollectables.push(new collectable("special"))}}function pulse(){if(!0===vars.powerBallVisible){vars.powerBallColour==vars.powerBallMaxColour?vars.powerBallMaxColour:vars.powerBallColour++;let e=vars.powerBallColour+12;for(collectableList=vars.levelCollectables,i=0;i<collectableList.length;i++)"power"===collectableList[i].collectable.name&&collectableList[i].collectable.setTexture("collectables",e)}}class enemy{constructor(e,s,a){this.animPosition=0,this.spriteType=a,this.initX=this.x=e,this.initY=this.y=s,this.facing="forward",this.selectedAnimation,this.currentVelocities=[],this.tween,this.moveToX=e,this.moveToY=s,this.paused=!1,this.alive=!0,this.evolved=!1,this.doesEvolve=!1,this.moveTimer=60,this.init()}areMovesViable(e){let s=vars.platformPositions,a=[],t={};for(let o=0;o<e.length;o++){let r=e[o];t[r]={valid:!0};for(let e=0;e<s.length;e++){let t=s[e].x,o=s[e].x+s[e].width,i=s[e].y,l=s[e].y+s[e].height,n=!0;switch(r){case"up":this.enemy.x>t&&this.enemy.x<o&&this.enemy.y-vars.bombOffset<l&&(n=!1);break;case"down":this.enemy.x>t&&this.enemy.x<o&&this.enemy.y+vars.bombOffset>i&&(n=!1);break;case"flyLeft":this.enemy.y>i&&this.enemy.y<l&&this.enemy.x-vars.bombOffset<o&&(n=!1);break;case"flyRight":this.enemy.y>i&&this.enemy.y<l&&this.enemy.x+vars.bombOffset>t&&(n=!1)}a.push({platformNumber:e,direction:r,valid:n})}}for(let e=0;e<a.length;e++)0==a[e].valid&&(t[a[e].direction].valid=!1);return t}generateTween(){this.x!=this.moveToX?this.tween=scene.tweens.addCounter({from:this.x,to:this.moveToX,ease:"Linear",duration:990,yoyo:!1}):this.tween=scene.tweens.addCounter({from:this.y,to:this.moveToY,ease:"Linear",duration:990,yoyo:!1})}init(){let e=this.spriteType;switch("enemyRobot"===e&&(e=vars.level>1||vars.completionCount>0?robotRandomiser():vars.enemyRobotTypes[0]),this.enemy=enemys.create(this.x,this.y,e),this.enemy.setSize(28,28),this.enemy.setBounce(1,0),this.enemy.setCollideWorldBounds(!0),0==vars.hires&&this.enemy.setScale(vars.lowResUpScale,vars.lowResUpScale),this.spriteType){case"enemyBird":this.enemy.body.allowGravity=!1;break;case"enemyRobot":this.doesEvolve=!0;var s=this.directionRobot();console.log("Selected impulse for robot is: "+s),this.currentVelocities=[s,0],5!==vars.level?this.enemy.setData("isFalling",!1):this.enemy.setData("isFalling",!0),this.enemy.setData("doesEvolve",!0),this.enemy.setData("hasEvolved",!1)}this.enemy.moving=!0;let a=generateRandomID();if(this.enemy.name=this.spriteType+a,"enemyBird"==this.spriteType)this.enemy.anims.play("turning"),this.move();else{let e="enemyRobot";(vars.level>1||vars.completionCount>0)&&(e=robotRandomiser()),this.enemy.setData("spriteType","enemyRobot"),this.enemy.setData("selectedSprite",e),-100===s?"enemyRobot"===e?this.enemy.anims.play("robotWalkLeft"):this.enemy.anims.play("robotWalkLeft2"):"enemyRobot"===e?this.enemy.anims.play("robotWalkRight"):this.enemy.anims.play("robotWalkRight2"),this.enemy.setVelocity(this.currentVelocities[0],this.currentVelocities[1])}}move(){!0===this.enemy.moving&&"enemyBird"===this.spriteType&&this.moveBird()}moveBird(){let e=[];if(0==this.moveTimer){this.moveTimer=60,this.x<player.x&&this.x<vars.enemyPositions.x[8]?e.push("flyRight"):this.x>player.x&&this.x>vars.enemyPositions.x[0]&&e.push("flyLeft"),0!=e.length&&(e[0].toLowerCase().match(this.facing)||"forward"==this.facing||(this.facing="forward",this.moveTimer=20)),this.y<player.y&&this.y<vars.enemyPositions.y[8]?e.push("down"):this.y>player.y&&this.y>vars.enemyPositions.y[0]&&e.push("up");let s=this.areMovesViable(e);e=[];for(const a in s)!0===s[a].valid&&e.push(a);let a="";if(e.length>0){a=e[~~(Math.random()*e.length)]}else a="turn",this.facing="forward";switch(a){case"up":case"down":case"turn":this.selectedAnimation="turning";break;default:this.selectedAnimation=a}let t=!0;switch(a){case"up":this.moveToX=this.x,this.moveToY=this.y-vars.bombOffset;break;case"down":this.moveToX=this.x,this.moveToY=this.y+vars.bombOffset;break;case"flyLeft":this.moveToX=this.x-vars.bombOffset,this.moveToY=this.y;break;case"flyRight":this.moveToX=this.x+vars.bombOffset,this.moveToY=this.y;break;default:t=!1}!0===t&&this.generateTween(),this.enemy.anims.play(this.selectedAnimation)}else this.moveTimer--}moveRobot(){}directionRobot(){let e=-100;return 1===~~(2*Math.random())&&(e=100),e}}function disableEnemies(e){vars.enemiesCollectable=e,enemyList=vars.levelEnemies;for(let s=0;s<enemyList.length;s++)currentEnemy=enemyList[s],"enemyBird"===currentEnemy.spriteType?!0===e?(currentEnemy.enemy.moving=!1,currentEnemy.enemy.anims.pause(),currentEnemy.enemy.setTexture("enemyCollectable",0)):(currentEnemy.enemy.moving=!0,currentEnemy.enemy.anims.resume()):!0===e?disableEnemyRobot(currentEnemy):(currentEnemy.enemy.moving=!0,currentEnemy.enemy.anims.resume(),!1===currentEnemy.enemy.getData("hasEvolved")?currentEnemy.enemy.body.allowGravity=!0:currentEnemy.enemy.body.allowGravity=!1,currentEnemy.enemy.setVelocity(currentEnemy.currentVelocities[0],currentEnemy.currentVelocities[1]))}function disableEnemyRobot(e){e.enemy.moving=!1,e.currentVelocities=[e.enemy.body.velocity.x,e.enemy.body.velocity.y],e.enemy.body.allowGravity=!1,e.enemy.setVelocity(0,0),e.enemy.setTint("0xffffff"),e.enemy.anims.pause(),e.enemy.setTexture("enemyCollectable",0)}function enemyHitGameBorder(e,s){"enemyRobot"===e.getData("spriteType")&&!1===e.getData("hasEvolved")&&(!0===e.getData("isFalling")&&3===s.getData("id")&&(reenableInvisWalls(e),!0===vars.DEBUG&&console.log("Robot evolving"),e.setData("hasEvolved",!0),e.anims.play("robotEvolving"),e.setTint(vars.evolveColours[~~(Math.random()*vars.evolveColours.length)]),e.body.allowGravity=!1,e.setVelocity(0,0),e.setBounce(0,0),setTimeout((function(){if(!1===vars.pBCollected){let s=robotRandomiser("evolved");e.setData("evolvedSprite",s),e.anims.play(s),e.setTint("0xffffff"),e.setBounce(1,1),e.setVelocity(200,-200)}else{let s="";for(let a=0;a<vars.levelEnemies.length;a++)if(vars.levelEnemies[a].enemy.name===e.name){!0===vars.DEBUG&&console.log("Evolving Enemy Found ("+e.name+"). Disabling the specific robot."),s=vars.levelEnemies[a];break}""!==s?(e.setBounce(1,1),e.setVelocity(200,-200),disableEnemyRobot(s)):console.log("Evolving enemy cant be found... <--- this is a problem if you ever see this message!")}}),500),spawnRobot()),1!==s.getData("id")&&2!==s.getData("id")||turnRobot(e,!0))}function enemyHitWall(e,s){let a=e.getData("spriteType");if("enemyRobot"===a&&!1===e.getData("hasEvolved")){!0===vars.DEBUG&&console.log("Enemy of type: "+a+" hit wall."),!0===e.getData("isFalling")&&reenableInvisWalls(e);let t=s.getData("bounceCount");0===t?(s.disableBody(!0),e.setData("wallBreakID",s.getData("id")),e.setData("isFalling",!0)):(s.setData("bounceCount",t-1),turnRobot(e))}}function hitEnemy(e,s){if(1==s.moving)vars.lives-1==0?(scene.physics.pause(),stopAllMusic(),vars.levelEnemies=[],showGameOver(),e.setTint(16711680),e.anims.play("turn"),gameOver=!0):(removeLife(),!0===vars.DEBUG&&console.log("Lives Left: "+vars.lives));else{mns.sfx_collectNormalBomb.audio.play(),s.disableBody(!0,!0);let e=s.name;for(let s=0;s<vars.levelEnemies.length;s++)e===vars.levelEnemies[s].enemy.name&&(vars.levelEnemies[s].alive=!1,vars.levelEnemies[s].enemy.setTexture(vars.levelEnemies[s].enemy.spriteType));vars.enemyDeathCount+=1;let a=s.body.x,t=s.body.y;vars.enemyDeathCount<=vars.enemyPoints.length?updateScore(a,t,vars.enemyPoints[vars.enemyDeathCount-1]):updateScore(a,t,vars.enemyPoints[vars.enemyPoints.length-1])}}function reenableInvisWalls(e){e.setData("isFalling",!1),invisWalls.children.each((function(s){if(s.getData("id")===e.getData("wallBreakID")){s.enableBody(),s.setData("bounceCount",3),s.getData("id")%2==0?opposingWall=parseInt(s.getData("id"))+1:opposingWall=parseInt(s.getData("id"))-1;for(let e=0;e<vars.invisibleWalls.length;e++)vars.invisibleWalls[e].getData("id")===opposingWall&&vars.invisibleWalls[e].setData("bounceCount",3)}}))}function resetEnemies(){let e=vars.levelEnemies;for(let s=0;s<e.length;s++)e[s].alive=!0,"enemyBird"===e[s].spriteType?(e[s].moveToX=e[s].x=e[s].enemy.x=e[s].initX,e[s].moveToY=e[s].y=e[s].enemy.y=e[s].initY,e[s].enemy.setVelocity(0,0)):(e[s].enemy.setData("hasEvolved",!1),e[s].enemy.setData("isFalling",!1),e[s].enemy.setData("wallBreakID",-1),e[s].enemy.setPosition(e[s].initX,e[s].initY),e[s].enemy.anims.resume(),e[s].enemy.setVelocity(-100,0),e[s].enemy.setBounce(1,0),e[s].enemy.body.allowGravity=!0);resetInvisWalls()}function resetInvisWalls(){invisWalls.children.each((function(e){e.setData("bounceCount",3),e.enableBody()}))}function robotRandomiser(e="normal"){let s="";return"normal"===e?(s=vars.enemyRobotTypes[~~(Math.random()*vars.enemyRobotTypes.length)],!0===vars.DEBUG&&console.log("New Sprite Name (robots):"+s)):"evolved"===e&&(s=vars.evolvedSpriteNames[~~(Math.random()*vars.evolvedSpriteNames.length)],!0===vars.DEBUG&&console.log("New Sprite Name (evolved robots):"+s)),s}function turnRobot(e,s=!1){let a=0;!1===s?(a=-1*e.body.velocity.x,e.body.velocity.x*=-1):a=e.body.velocity.x;let t=e.getData("selectedSprite");100===a?("enemyRobot"===t?e.anims.play("robotWalkRight"):e.anims.play("robotWalkRight2"),e.body.x+=1):("enemyRobot"===t?e.anims.play("robotWalkLeft"):e.anims.play("robotWalkLeft2"),e.body.x-=1)}var scoreText,score=0;soundLoader(),scoreTextArray=[{word:"FANTASTIC SCORE!",x:240,y:60,colour:"0xFF5008",visible:!1,groupName:"score"},{word:"RECORD YOUR NAME",x:240,y:108,colour:"0xFF5008",visible:!1,groupName:"score"},{word:"1ST",x:60,y:156,colour:"0xFFFF00",visible:!1,groupName:"score"},{word:"2ND",x:60,y:204,colour:"0xFFFF00",visible:!1,groupName:"score"},{word:"3RD",x:60,y:252,colour:"0xFFFF00",visible:!1,groupName:"score"},{word:"4TH",x:60,y:300,colour:"0xFFFF00",visible:!1,groupName:"score"},{word:"5TH",x:60,y:348,colour:"0xFFFF00",visible:!1,groupName:"score"},{word:"6TH",x:60,y:396,colour:"0xFFFF00",visible:!1,groupName:"score"},{word:"7TH",x:60,y:444,colour:"0xFFFF00",visible:!1,groupName:"score"},{word:"8TH",x:60,y:492,colour:"0xFFFF00",visible:!1,groupName:"score"},{word:"9TH",x:60,y:540,colour:"0xFFFF00",visible:!1,groupName:"score"},{word:"10TH",x:60,y:588,colour:"0xFFFF00",visible:!1,groupName:"score"},{word:"100000",x:252,y:156,colour:"0xFFFFFF",visible:!1,groupName:"score"},{word:"T.T",x:540,y:156,colour:"0xFFFFFF",visible:!1,groupName:"score"},{word:"E.E",x:540,y:204,colour:"0xFFFFFF",visible:!1,groupName:"score"},{word:"H.H",x:540,y:252,colour:"0xFFFFFF",visible:!1,groupName:"score"},{word:"K.K",x:540,y:300,colour:"0xFFFFFF",visible:!1,groupName:"score"},{word:"A.A",x:540,y:348,colour:"0xFFFFFF",visible:!1,groupName:"score"},{word:"N.N",x:540,y:396,colour:"0xFFFFFF",visible:!1,groupName:"score"},{word:"L.L",x:540,y:444,colour:"0xFFFFFF",visible:!1,groupName:"score"},{word:"T.T",x:540,y:492,colour:"0xFFFFFF",visible:!1,groupName:"score"},{word:"D.D",x:540,y:540,colour:"0xFFFFFF",visible:!1,groupName:"score"},{word:"04©",x:540,y:588,colour:"0xFFFFFF",visible:!1,groupName:"score"},{word:"ROUND",x:700,y:156,colour:"0x00FF00",visible:!1,groupName:"score"},{word:"1",x:924,y:156,colour:"0xFFFFFF",visible:!1,groupName:"score"}],uiTextArray=[{word:"PUSH",x:345,y:370,colour:"0xFF5008",visible:!0,groupName:"msLine"},{word:"1 PLAYER BUTTON ONLY",x:90,y:434,colour:"0xffffff",visible:!0,groupName:"msLine"},{word:"REMAKE",x:315,y:496,colour:"0xffffff",visible:!0,groupName:"msLine"},{word:"BY",x:380,y:560,colour:"0xffffff",visible:!0,groupName:"msLine"},{word:"OFFER0 04",x:270,y:624,colour:"0x24CB27",visible:!0,groupName:"msLine"},{word:"CREDIT",x:270,y:720,colour:"0xFD9301",visible:!0,groupName:"msLine"},{word:"01",x:495,y:720,colour:"0xFD9301",visible:!0,groupName:"msLine"},{word:"PRESS SPACE OR JOY A",x:80,y:798,colour:"0xffff00",visible:!0,groupName:"msLine"},{word:"SCORE:",x:40,y:800,colour:"0xffffff",visible:!1,groupName:"gLine"},{word:"STAGE:",x:560,y:800,colour:"0x00ff00",visible:!1,groupName:"gLine"},{word:"CONTROLS",x:272,y:406,colour:"0x00FF00",visible:!1,groupName:"msLine1"},{word:"< CURSOR KEYS >",x:160,y:502,colour:"0xFFFFFF",visible:!1,groupName:"msLine1"},{word:"[SPACE] JUMP",x:208,y:550,colour:"0xFFFFFF",visible:!1,groupName:"msLine1"},{word:"[S] SOUND",x:144,y:598,colour:"0xFFFFFF",visible:!1,groupName:"msLine1"},{word:"ON",x:464,y:598,colour:"0x00FF00",visible:!1,groupName:"msLine1"},{word:":",x:528,y:598,colour:"0xFFFFFF",visible:!1,groupName:"msLine1"},{word:"OFF",x:560,y:598,colour:"0xFF0000",visible:!1,groupName:"msLine1"},{word:"[M] MUSIC",x:144,y:646,colour:"0xFFFFFF",visible:!1,groupName:"msLine1"},{word:"ON",x:464,y:646,colour:"0x00FF00",visible:!1,groupName:"msLine1"},{word:":",x:528,y:646,colour:"0xFFFFFF",visible:!1,groupName:"msLine1"},{word:"OFF",x:560,y:646,colour:"0xFF0000",visible:!1,groupName:"msLine1"},{word:"[+] VOLUME UP",x:192,y:694,colour:"0xFFFFFF",visible:!1,groupName:"msLine1"},{word:"[-] VOLUME DOWN",x:160,y:742,colour:"0xFFFFFF",visible:!1,groupName:"msLine1"},{word:"REMAKE IN HTML5",x:168,y:406,colour:"0xFFFFFF",visible:!1,groupName:"msLine2"},{word:"JS (ES6) PHASER 3.22",x:72,y:454,colour:"0xFFFFFF",visible:!1,groupName:"msLine2"},{word:"REMAKE BY 0FFERO 04",x:88,y:550,colour:"0xFFFFFF",visible:!1,groupName:"msLine2"},{word:"© MAR 2020",x:248,y:598,colour:"0xFFFFFF",visible:!1,groupName:"msLine2"},{word:"STILL TO DO",x:232,y:646,colour:"0xFFFF00",visible:!1,groupName:"msLine2"},{word:"SOME ANIMATIONS",x:168,y:694,colour:"0xFFFFFF",visible:!1,groupName:"msLine2"},{word:"NEW WALKER TYPES",x:152,y:742,colour:"0xFFFFFF",visible:!1,groupName:"msLine2"},{word:"ONLY TESTED IN CHROME",x:72,y:790,colour:"0xFD9301",visible:!1,groupName:"msLine2"}],bonusTextArray=[{word:"YOU'VE GOTTEN",x:205,y:240,colour:"0xffff00",visible:!1,groupName:"bLine"},{word:"FIRE BOMBS.",x:300,y:300,colour:"0xffff00",visible:!1,groupName:"bLine"},{word:"SPECIAL BONUS.",x:200,y:380,colour:"0xffffff",visible:!1,groupName:"bLine"},{word:"POINTS",x:420,y:450,colour:"0xffffff",visible:!1,groupName:"bLine"},{word:"20",x:210,y:300,colour:"0xFF23CB",visible:!1,groupName:"bCount20"},{word:"21",x:210,y:300,colour:"0xFF23CB",visible:!1,groupName:"bCount21"},{word:"22",x:210,y:300,colour:"0xFF23CB",visible:!1,groupName:"bCount22"},{word:"23",x:210,y:300,colour:"0xFF23CB",visible:!1,groupName:"bCount23"},{word:"10000",x:220,y:450,colour:"0xFF23CB",visible:!1,groupName:"10000"},{word:"20000",x:220,y:450,colour:"0xFF23CB",visible:!1,groupName:"20000"},{word:"30000",x:220,y:450,colour:"0xFF23CB",visible:!1,groupName:"30000"},{word:"50000",x:220,y:450,colour:"0xFF23CB",visible:!1,groupName:"50000"}];var vars={DEBUG:!0,version:"0.993",lowResUpScale:1.5,hires:!1,credits:1,lives:3,playerIsDead:!1,mainScreenTimer:540,mainScreenTimerMax:540,msLineCurrent:0,msLinemax:2,msLineTimeouts:[1500,2e3,2750],deathTween:"",livesContainer:{x:380,y:825,currentOffset:0,offsetX:32},extraLifeBombCount:0,score:0,powerBallCounter:0,powerBallVisible:!1,powerBallColour:0,powerBallMaxColour:6,pBBounceCount:3,pBLastColourChange:0,pBCollected:!1,level:1,animTimeOut:5,animated:!0,enemyPositions:{x:[],y:[]},mainScreenUIText:uiTextArray,bonusMultiplier:1,scoreSinceLast5k:0,bonusMultiplierImg:[],bonusText:bonusTextArray,colours:{blues:[[0,85,255],[0,136,255],[0,187,255]],oranges:[[255,0,136],[255,170,0]]},blues:{currentOffset:1,cutWidth:674,cutHeight:273,cutPadLeft:60,cutPadTop:10,blue1:[],blue2:[],blue3:[]},levelIntroVisible:!1,levelEnemies:[],robotSpawnPositions:[],invisibleWalls:[],enemiesCollectable:!1,enemyFlashCount:0,enemyDeathCount:0,enemyPoints:[100,200,300,500,800,1e3,1200,2e3,3e3,5e3],enemyRobotTypes:["enemyRobot","enemyRobot2"],evolveColours:["0xffff00","0xff0000","0x00ff00","0x0000ff"],evolvedSpriteNames:["robotEvolved","robotEvolved2","robotEvolved3"],levelCollectables:[],platformPositions:[],currentBGM:1,vgVisible:!0,volumeBG:"",volumeGraphic:[],volumeColours:[],volumeHide:0,volumeHideMax:0,BGMEnabled:!0,currentBomb:-1,bombTrack:"",bombRun:0,completionCount:0,gameStarted:!1,showStartScreen:!0,isPaused:!0,bombOffset:81,xOffset:75,yOffset:91,inAir:!1,jumpTimeOut:10,jumpTimeOutMax:10,alpha:{},deathResets:function(){let e=1;vars.level>1&&(e+=1);for(let s=e;s<vars.levelEnemies.length;s++)vars.levelEnemies[s].enemy.destroy();vars.levelEnemies=vars.levelEnemies.slice(0,e),spawnRobot(),vars.enemyDeathCount=0,vars.currentBomb=-1,vars.bombRun=0,bombs.children.each((function(e){e.anims.play("normal")})),vars.inAir=!0,vars.bonusMultiplier=1,vars.scoreSinceLast5k=0,vars.bonusMultiplierImg[1].setTexture("bonusMultipliers",1),vars.resetPowerBall();let s="";for(let e=0;e<vars.levelCollectables.length;e++)s=vars.levelCollectables[e],s.collectable.destroy()},newLevelResets:function(){vars.robotSpawnPositions=[],vars.invisibleWalls=[],invisWalls.children.each((function(e){e.destroy()})),vars.enemyDeathCount=0,vars.levelCollectables=[],vars.platformPositions=[],vars.currentBomb=-1,vars.bombTrack="",vars.bombRun=0,vars.inAir=!1,vars.bonusMultiplier=1,vars.bonusMultiplierImg[1].setTexture("bonusMultipliers",1),vars.levelEnemies=[],stopAllMusic()},resetPowerBall:function(){"undefined"!=typeof resetPowerBall&&(clearTimeout(resetPowerBall),resetPowerBall=void 0),"undefined"!=typeof flashingEnemies&&(clearTimeout(flashingEnemies),flashingEnemies=void 0),"undefined"!=typeof flashCT&&(clearInterval(flashCT),flashCT=void 0);for(let e=0;e<vars.levelEnemies.length;e++)currentEnemy=vars.levelEnemies[e],!0===currentEnemy.enemy.getData("isAlive")&&(currentEnemy.visible=!0);disableEnemies(!1),mns.sfx_powerBallCollected.audio.stop(),vars.enemyDeathCount=0,vars.powerBallCounter=0,vars.powerBallVisible=!1,vars.powerBallColour=0,vars.pBBounceCount=3,vars.pBLastColourChange=0,vars.pBCollected=!1}};for(versionTextArray=[{word:"V"+vars.version,x:800-32*(vars.version.length+1),y:20,colour:"0xffd700",visible:!0,groupName:"version"}],vars.versionTextArray=versionTextArray,i=vars.xOffset;i<vars.xOffset+9*vars.bombOffset;i+=vars.bombOffset)vars.enemyPositions.x.push(i);for(i=vars.yOffset;i<vars.yOffset+9*vars.bombOffset;i+=vars.bombOffset)vars.enemyPositions.y.push(i);for(position=0,i=65;i<=90;i++)vars.alpha[String.fromCharCode(i)]=position,position++;for(i=0;i<10;i++)vars.alpha[i]=position,position++;for(alphaExtras=["(",")","'","!",".","-","©","®","[","]","=","+",":","<",">","^","#"," "],i=0;i<alphaExtras.length;i++)vars.alpha[alphaExtras[i]]=position,position++;vars.volumeHideMax=vars.volumeHide=180,vars.vgVisible=!0,setUpVolumeColours();var config={type:Phaser.AUTO,width:800,height:850,title:"bombJackArcade",parent:"containerBombJack",input:{gamepad:!0},physics:{default:"arcade",arcade:{gravity:{y:600},debug:!1}},scene:{preload:preload,create:create,update:update}};function preload(){this.load.setPath("assets"),1==vars.hires?(this.load.spritesheet("sky","backgrounds800x800_hires.jpg",{frameWidth:800,frameHeight:800}),this.load.spritesheet("bomb","bomb_hires.png",{frameWidth:55,frameHeight:50}),this.load.spritesheet("jack","bombjack",{frameWidth:32,frameHeight:32}),this.load.image("mainScreen","mainScreenHiRes.png"),vars.animated=!1):(this.load.spritesheet("sky","backgrounds800x800.png",{frameWidth:800,frameHeight:800}),this.load.spritesheet("bomb","bomb.png",{frameWidth:50,frameHeight:50}),this.load.spritesheet("jack","bombjack.png",{frameWidth:32,frameHeight:32}),this.load.image("mainScreen","mainScreen.png")),this.load.image("ground_hc","platform_hc.png"),this.load.image("ground_vc","platform_vc.png"),this.load.image("ground_hbw","platform_hbw.png"),this.load.image("ground_vbw","platform_vbw.png"),this.load.image("invisWall","invisibleWall.png"),this.load.image("bonusBox","bonusBox.png"),this.load.spritesheet("bonusMultipliers","bonusMultipliers.png",{frameWidth:32,frameHeight:32}),this.load.spritesheet("enemyBird","enemyBird.png",{frameWidth:32,frameHeight:32}),this.load.spritesheet("enemyRobot","enemyRobot.png",{frameWidth:32,frameHeight:32}),this.load.spritesheet("enemyRobot2","enemyRobot2.png",{frameWidth:32,frameHeight:32}),this.load.spritesheet("robotEvolved","robotEvolved.png",{frameWidth:32,frameHeight:30}),this.load.spritesheet("robotHitFloor","enemyRobotHitFloor.png",{frameWidth:32,frameHeight:30}),this.load.image("enemyCollectable","enemyCollectable.png"),this.load.spritesheet("collectables","collectables.png",{frameWidth:50,frameHeight:50}),this.load.image("bonusScreen","bonusScreen.png"),this.load.spritesheet("start","start.png",{frameWidth:224,frameHeight:48}),this.load.spritesheet("scores","scores.png",{frameWidth:32,frameHeight:12}),this.load.spritesheet("alpha","alpha.png",{frameWidth:32,frameHeight:32}),this.load.image("blackBG","blackBackground.png"),this.load.image("bSquare","blackSquare.gif"),game.canvas.id="bombJack"}function create(){scene=this,cursors=this.input.keyboard.createCursorKeys(),jumpButton=this.input.keyboard.addKey("space"),jumpButton.on("down",(function(){playerJump()})),soundDisable=this.input.keyboard.addKey("S"),soundDisable.on("up",(function(){disableSound()})),soundVolumeUp=this.input.keyboard.addKey("plus"),soundVolumeUp.on("up",(function(){soundVolume("up")})),soundVolumeDown=this.input.keyboard.addKey("minus"),soundVolumeDown.on("up",(function(){soundVolume("down")})),musicOn=this.input.keyboard.addKey("M"),musicOn.on("up",(function(){musicEnable()})),!0===vars.DEBUG&&(debuggerKey=this.input.keyboard.addKey("D"),debuggerKey.on("down",(function(){}))),gameBorders=this.physics.add.staticGroup(),platforms=this.physics.add.staticGroup(),bombs=this.physics.add.staticGroup(),enemys=this.physics.add.group(),messages=this.physics.add.staticGroup(),collectables=this.physics.add.group(),livesBar=this.physics.add.staticGroup(),invisWalls=this.physics.add.staticGroup(),scoreGroup=this.physics.add.staticGroup(),roundGroup=this.physics.add.staticGroup(),bonusImage=this.add.image(400,400,"bonusScreen"),bonusText=this.physics.add.staticGroup(),setUpBonusScreen(),blackBG=this.add.image(400,400,"blackBG"),blackBG.visible=!1,drawMainScreen(),buildVolumeGraphic(),gameInputText=this.add.text(10,830,"Press a button on the Gamepad to use",{font:"16px Courier",fill:"#00ff00"}),gameInputText.visible=!1;let e=gameInputText.width,s=400-e/2;gameInputText.x=s,this.input.gamepad.once("down",(function(a,t,o){gameInputText.setText("Playing with "+a.id),e=gameInputText.width,s=400-e/2,gameInputText.x=s,gamePad=a,gamePad.on("down",(e,s,a)=>{switch(a.index){case 0:case 1:case 2:case 3:!0===vars.gameStarted?playerJump():(vars.showStartScreen=!1,vars.gameStarted=!0,initGame());break;case 8:musicEnable();break;case 12:soundVolume("up");break;case 13:soundVolume("down")}})}),this)}function drawMainScreen(){bgImage=scene.add.image(400,450,"mainScreen"),setUpAnimatedLogo(),setUpUIText(vars.mainScreenUIText,messages),setUpUIText(vars.versionTextArray,messages)}function fontify(e,s,a,t,o,r,l,n=!1){if(spriteSheet="alpha",messageImage="",(e=e.toUpperCase()).length>0&&Number.isInteger(s)&&Number.isInteger(a))for(!0===n&&l.children.each((function(e){e.destroy()})),msgArray=e.split(""),i=0;i<msgArray.length;i++)null==vars.alpha[msgArray[i]]?spriteFrame=vars.alpha[" "]:spriteFrame=vars.alpha[msgArray[i]],msgPart=l.create(s+32*i,a,"alpha",spriteFrame).setTint(t),msgPart.visible=o,msgPart.name=r,messageImage+=msgPart;else console.log("Error with message, posX or posY")}function generateRandomID(){generatedID="";for(let e=0;e<8;e++)for(let e=0;e<5;e++)4==e?generatedID+=~~(9*Math.random()+1).toString():(9*Math.random()+1).toString();return generatedID}function generateRoundImage(){roundMsg="ROUND",fontify(roundMsg,40,825,"0x00ff00",!0,"roundG",roundGroup,!0),roundMsg=vars.completionCount+"-"+vars.level,fontify(roundMsg,210,825,"0x00e6ff",!0,"roundG",roundGroup)}function initGame(){gameInputText.visible=!1,!0===vars.vgVisible&&(vars.volumeHide=1),scene.physics.pause(),document.getElementById("animMainScreen").style.display="none",drawGameBorders(),bgImage.setTexture("sky",0),startLeft=scene.add.image(0,450,"start",0),startRight=scene.add.image(800,450,"start",1),(scoreText=scene.add.text(40,805,"Score: 0",{font:"bold 36px Consolas",fill:"#000",stroke:"#FFF",strokeThickness:2})).visible=!1,scoreGroup.create(40,25,"alpha",26).setTint("0xffffff"),stageText=scene.add.text(560,805,"Stage: 0/1",{font:"bold 36px Consolas",fill:"#000",stroke:"#FFF",strokeThickness:2}),stageText.visible=!1,generateRoundImage(),player=scene.physics.add.sprite(400,400,"jack"),player.setSize(26,30,!0),0==vars.hires?player.setScale(vars.lowResUpScale,vars.lowResUpScale):player.setScale(1,1),generateAnimFrames(),drawLevel(bombs,platforms),scene.physics.add.collider(player,platforms),scene.physics.add.collider(player,gameBorders),scene.physics.add.overlap(player,bombs,collectbomb,null,this),scene.physics.add.collider(enemys,platforms),scene.physics.add.collider(enemys,gameBorders,enemyHitGameBorder,null,this),scene.physics.add.overlap(player,enemys,hitEnemy,null,this),scene.physics.add.overlap(enemys,invisWalls,enemyHitWall,null,this),scene.physics.add.collider(collectables,gameBorders,collideWithWall,null,this),scene.physics.add.collider(collectables,platforms,collideWithWall),scene.physics.add.overlap(player,collectables,pickUpCollectable,null,this),bonusBox=scene.add.image(400,25,"bonusBox",0),bonusBox.setCrop(40,0,88,36),vars.bonusMultiplierImg.push(scene.add.image(380,25,"bonusMultipliers",0)),vars.bonusMultiplierImg.push(scene.add.image(410,25,"bonusMultipliers",1)),showStartBanner(),startLeft.setDepth(1),startRight.setDepth(1),initialiseLives(),vars.isPaused=!1}function initialiseLives(){let e=vars.livesContainer.x,s=vars.livesContainer.y,a=vars.livesContainer.offsetX;for(let t=1;t<vars.lives;t++)livesBar.create(e,s,"jack",4),vars.livesContainer.currentOffset+=a,e+=a}function setUpUIText(e,s){for(key=0;key<e.length;key++)message=e[key].word,xPos=e[key].x,yPos=e[key].y,colour=e[key].colour,visible=e[key].visible,groupName=e[key].groupName,fontify(message,xPos,yPos,colour,visible,groupName,s)}function setUpBonusScreen(){bonusImage.visible=!1,setUpUIText(vars.bonusText,bonusText)}function setUpVolumeColours(){for(vars.volumeColours=[],vars.volumeColours.push({h:0,s:100,l:50}),hsl=11;hsl<110;hsl+=11)vars.volumeColours.push({h:Math.round(hsl),s:100,l:50});vars.volumeColours.push({h:110,s:100,l:50})}var levels={mapCount:16,gameBorders:[[0,50,800,.5,"h"],[0,50,1.5,747,"v"],[764,50,1.5,747,"v",!0],[0,772,800,1,"h"]],map1:{spritePositions:[0,1,1,1,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,0],bombTrack:[6,7,8,9,11,13,15,17,10,12,14,16,0,1,2,20,19,18,23,22,21,5,4,3],platformPositions:[[60,600,120,1],[140,270,120,1],[400,200,180,1],[320,520,160,1],[420,685,240,1]],bgImage:0},map2:{spritePositions:[0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],bombTrack:[15,16,17,6,7,8,11,10,9,2,1,0,3,4,5,12,13,14,18,19,20,21,22,23],platformPositions:[[-2,300,150,1],[573,300,150,1],[95,440,120,1],[500,440,120,1],[177,605,120,1],[420,605,120,1]],bgImage:1,platformColour:"0x00ff00"},map3:{spritePositions:[1,1,0,0,0,0,0,1,1,0,0,1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,1,0,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,0,1,1,0,0],bombTrack:[12,10,8,9,11,13,17,18,19,6,7,2,3,5,4,1,0,20,21,22,23,14,15,16],platformPositions:[[175,200,120,1],[420,200,120,1],[300,530,120,1],[65,600,100,1],[550,600,100,1]],bgImage:2},map4:{spritePositions:[0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,0,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1],bombTrack:[15,16,17,14,13,12,9,10,11,8,7,6,3,4,5,2,1,0,18,19,20,21,22,23],platformPositions:[[95,195,120,1],[500,195,120,1],[95,600,120,1],[500,600,120,1]],bgImage:3,platformColour:"0xffff00"},map5:{spritePositions:[0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,1,0,0,1,0,1,0,1,0,1,0,0,1,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,1,0,0,1,0,1,0,1,0,1,0,0,1,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0],bombTrack:[13,17,21,0,4,8,12,16,20,14,18,22,1,5,9,3,7,11,15,19,23,2,6,10],platformPositions:[],bgImage:4},map6:{spritePositions:[1,1,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,0,1,1,0,1,1,0,1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],bombTrack:[8,7,6,12,14,16,22,23,21,15,13,11,10,9,20,19,18,17,5,4,1,0,2,3],platformPositions:[[337,195,120,1],[-2,280,235,1],[150,525,330,1],[480,360,140,1],[470,360,1,190]],bgImage:0},map7:{spritePositions:[0,0,0,0,0,0,0,0,0,0,1,1,1,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,1,1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,1,0,0,1,1,0,0,1,0,1,0,0,1,1,0,0,1,0,1,0,0,1],bombTrack:[8,7,6,0,1,2,3,4,5,12,16,20,15,19,23,14,18,22,9,10,11,13,17,21],platformPositions:[[310,200,100,1],[310,605,100,1],[160,360,140,1],[410,360,140,1],[160,445,140,1],[410,445,140,1]],bgImage:1,platformColour:"0x00ff00"},map8:{spritePositions:[0,1,0,0,0,0,0,1,0,0,1,0,1,0,1,0,1,0,0,1,0,1,0,1,0,1,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,1,0,0,0,1,0,0,0,0,1,0,0,0,1,0,0,0,0,1,0,0,0,1,0,0],bombTrack:[14,13,12,22,20,18,3,7,10,0,2,6,1,5,9,4,8,11,23,21,19,17,16,15],platformPositions:[[90,280,140,1],[485,280,140,1],[90,522,140,1],[485,522,140,1],[225,146,1,160],[465,146,1,160],[225,522,1,160],[465,522,1,160]],bgImage:2},map9:{spritePositions:[0,0,0,0,0,1,1,1,0,0,1,1,0,0,0,0,0,0,0,1,1,0,0,0,1,1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,1,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,1,0,1],bombTrack:[12,13,14,18,20,22,9,8,7,19,21,23,2,1,0,11,6,4,3,5,10,15,16,17],platformPositions:[[310,125,70,1],[310,205,100,1],[230,285,180,1],[310,365,100,1],[310,445,265,1],[310,525,100,1],[45,605,360,1],[310,685,100,1],[300,125,1,106],[300,311,1,80],[300,445,1,106],[300,631,1,80]],bgImage:3},map10:{spritePositions:[0,1,0,0,0,0,0,1,0,0,1,0,0,0,1,0,1,0,0,1,1,0,0,1,0,1,0,0,0,1,0,0,1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,1,0,0,1,0,0,0,0,1,1,0,0,0,0,0,0,0,1],bombTrack:[13,16,20,1,4,8,18,21,23,0,2,5,15,19,22,3,7,10,12,14,17,6,9,11],platformPositions:[[140,202,240,1],[470,202,100,1],[140,642,100,1],[330,642,240,1],[140,202,1,466],[550,202,1,466]],bgImage:0},map11:{spritePositions:[1,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,0,0,1,1,1,0,0,1,0,1,0,0,0,0,0,1,1,0,1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,1],bombTrack:[14,16,17,18,19,23,22,21,20,1,2,3,11,12,9,8,7,6,0,4,5,10,13,15],platformPositions:[[-2,280,165,1],[-2,442,165,1],[-2,602,165,1],[558,198,165,1],[558,362,165,1],[558,525,165,1]],bgImage:1,platformColour:"0x00ff00"},map12:{spritePositions:[0,0,0,0,0,0,0,0,0,0,1,1,1,0,1,1,1,0,1,0,0,0,0,0,0,0,1,1,0,0,1,0,1,0,0,1,1,0,0,1,0,1,0,0,1,0,1,0,1,0,1,0,1,0,0,1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0],bombTrack:[18,14,10,9,13,17,3,4,5,6,8,12,16,20,22,2,1,0,7,11,15,19,21,23],platformPositions:[[160,200,400,1],[140,200,1,320],[550,200,1,320],[310,520,100,1]],bgImage:2},map13:{spritePositions:[0,1,1,1,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,1,0,1,0,0,0,1,0,1,1,0,1,0,0,0,1,0,1,1,0,0,1,0,1,0,0,1,0,0,0,1,0,1,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0],bombTrack:[18,21,23,13,9,6,19,15,11,5,4,3,2,1,0,8,12,16,7,10,14,22,20,17],platformPositions:[[170,117,135,1],[410,117,135,1],[310,280,100,1],[310,525,100,1],[170,682,135,1],[410,682,135,1],[60,230,1,130],[60,470,1,130],[630,230,1,130],[630,470,1,130],[225,365,1,100],[465,365,1,100]],bgImage:3},map14:{spritePositions:[0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,0,0,1,1,1,0,1,0,1,1,1,0,0,0,0,1,0,0,1,1,0,1,0,0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,0,0,1,1,1,0,0,0,1,0,0,0,0,0,0],bombTrack:[20,21,22,15,12,9,0,2,7,8,11,14,13,16,17,18,19,23,10,6,1,5,4,3],platformPositions:[[140,117,240,1],[380,117,1,180],[305,685,250,1],[305,505,1,180],[70,360,160,1],[60,360,1,260],[490,440,160,1],[630,210,1,256]],bgImage:0},map15:{spritePositions:[0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,0,1,0,0,0,0,1,1,1,0,0,0,0,1,1,0,0,0,1,1,0,0,1,1,0,0,0,1,1,0,0,1,1,0,0,0,1,1,0,0,1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0],bombTrack:[17,13,9,8,12,16,20,22,10,14,18,4,3,2,1,0,5,6,7,11,15,19,21,23],platformPositions:[[250,200,215,1],[250,620,215,1],[145,310,1,210],[550,310,1,210]],bgImage:1,platformColour:"0x00ff00"},map16:{spritePositions:[0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,0,1,1,0,0,1,1,0,0,0,0,0,1,1],bombTrack:[18,19,22,23,21,20,5,4,3,2,1,0,6,7,8,9,15,14,13,12,11,10,16,17],platformPositions:[[65,198,100,1],[310,198,100,1],[550,198,100,1],[65,520,100,1],[310,520,100,1],[550,520,100,1],[175,360,125,1],[415,360,125,1],[175,685,125,1],[415,685,125,1]],bgImage:2}};function clearLevel(){bonusImage.visible=!1,enemys.children.iterate((function(e){e.disableBody(!0,!0)})),vars.levelEnemies=[],platforms.children.iterate((function(e){e.disableBody(!0,!0)})),platforms.children.clear(),bombs.children.iterate((function(e){e.disableBody(!0,!0)})),bombs.children.clear(),collectables.children.iterate((function(e){e.disableBody(!0,!0)})),collectables.children.clear(),vars.levelCollectables=[],vars.newLevelResets(),bgImage.visible=!1,blackBG.visible=!0}function drawGameBorders(){for(gameBorderList=levels.gameBorders,i=0;i<gameBorderList.length;i++)currentBorder=gameBorderList[i],pX=currentBorder[0],pY=currentBorder[1],pW=currentBorder[2],pH=currentBorder[3],ground=currentBorder[4],gameBorder=gameBorders.create(pX,pY,"ground_"+ground+"c"),gameBorder.setData("id",i),null!=currentBorder[5]&&(gameBorder.flipX=!0),gameBorder.setOrigin(0,0).setScale(pW,pH).refreshBody()}function drawLevel(e,s){for(hideUIText(),roundMsg="ROUND "+vars.completionCount+"-"+vars.level,generateRoundImage(),stageText.setText(roundMsg),currentMap=levels["map"+vars.level].spritePositions,frameNumber=levels["map"+vars.level].bgImage,bgImage.setFrame(frameNumber),bgImage.visible=!0,currentY=0,bombNumber=0,i=0;i<currentMap.length;i++)if(i%9==0&&i>0&&(currentY+=vars.bombOffset),1==currentMap[i]){currentX=i%9*vars.bombOffset;var a=e.create(currentX+vars.xOffset,currentY+vars.yOffset,"bomb");a.setSize(38,38,!0),a.id=bombNumber,bombNumber++}for(platformList=levels["map"+vars.level].platformPositions,platformColour=levels["map"+vars.level].platformColour,i=0;i<platformList.length;i++)if(currentPlatform=platformList[i],horizontal=!1,pX=currentPlatform[0],pY=currentPlatform[1],pW=currentPlatform[2],pH=currentPlatform[3],pW>pH?(platImage="ground_h",horizontal=!0):platImage="ground_v",null!=platformColour?(tintColour=platformColour,platImage+="bw"):(tintColour="0xffffff",platImage+="c"),platform=s.create(pX+41,pY,platImage),platform.setOrigin(0,0).setScale(pW,pH).refreshBody(),platform.setTint(tintColour),!0===horizontal){vars.invisibleWalls.push(invisWalls.create(pX+41-5,pY-20,"invisWall",0,!1)),vars.invisibleWalls.push(invisWalls.create(pW+pX+41+5,pY-20,"invisWall",0,!1));let e=pX+.5*pW+46-8,s=pY-30;vars.robotSpawnPositions.push([e,s])}if(!0===vars.DEBUG&&console.log("Found "+vars.robotSpawnPositions.length+" robot spawn positions"),0===vars.robotSpawnPositions.length)for(t=1;t<8;t+=2)vars.robotSpawnPositions.push([vars.enemyPositions.x[t],vars.enemyPositions.y[0]]);for(i=0;i<vars.invisibleWalls.length;i++)vars.invisibleWalls[i].setData("id",i),vars.invisibleWalls[i].setData("bounceCount",3);vars.platformPositions=[];for(let e=0;e<s.children.size;e++)vars.platformPositions.push({x:s.children.entries[e].x,y:s.children.entries[e].y,width:s.children.entries[e].displayWidth,height:s.children.entries[e].displayHeight});updateBorders(tintColour),vars.currentBomb=-1,vars.bombTrack=levels["map"+vars.level].bombTrack,vars.level>1&&vars.levelEnemies.push(new enemy(vars.enemyPositions.x[vars.enemyPositions.x.length-1],vars.enemyPositions.y[0],"enemyBird")),vars.levelEnemies.push(new enemy(vars.enemyPositions.x[0],vars.enemyPositions.y[0],"enemyBird")),spawnRobot(),player.setPosition(400,400,0)}function hideUIText(){"undefined"!=typeof fadeInterval&&clearInterval(fadeInterval),vars.mainScreenTimer=vars.mainScreenTimerMax,messages.children.iterate((function(e){e.visible=!1}))}function spawnRobot(){let e=[],s="",a=0,t=0;for(let o=0;o<vars.robotSpawnPositions.length;o++)s=vars.robotSpawnPositions[o],a=s[0],t=s[1],(Phaser.Math.Difference(400,t)>100||t<390||Phaser.Math.Difference(400,a)>100)&&e.push(vars.robotSpawnPositions[o]);let o=e[~~(Math.random()*e.length)],r=o[0],i=o[1];vars.levelEnemies.push(new enemy(r,i,"enemyRobot"))}function updateBorders(e){selectedTextureType="bw","0xffffff"!=e&&""!=e||(selectedTextureType="c"),gameBorders.children.iterate((function(s){s.scaleX>s.scaleY?selectedTexture="ground_h"+selectedTextureType:selectedTexture="ground_v"+selectedTextureType,s.setTexture(selectedTexture),s.setTint(e)}))}function addLife(e=1){vars.lives+=e,livesBar.create(vars.livesContainer.x+vars.livesContainer.currentOffset,vars.livesContainer.y,"jack",4),vars.livesContainer.currentOffset+=vars.livesContainer.offsetX}function collideWithWall(e){"power"==e.name&&vars.pBLastColourChange>=60&&(vars.powerBallColour<vars.powerBallMaxColour-2?pulse():vars.pBBounceCount>0?vars.pBBounceCount-=1:(vars.pBBounceCount=3,pulse()))}function getBonusScore(){let e=0;switch(vars.bombRun-1){case 20:e=1e4;break;case 21:e=2e4;break;case 22:e=3e4;break;case 23:e=5e4}return e}function getClosestPlatform(){let e=parseInt(player.x),s=parseInt(player.y),a=vars.platformPositions,t=[];for(let o=0;o<a.length;o++)sX=a[o].x,eX=a[o].x+a[o].width,sY=a[o].y,e>=sX&&e<=eX&&s<sY&&t.push(sY);let o=0;if(0===t.length)o=levels.gameBorders[3][1];else if(1===t.length)o=t[0];else if(t.length>1){o=t[0];for(let e=1;e<t.length;e++)t[e]<o&&(o=t[e])}return[o,2e3/850*o]}function hideBonusScreen(){bonusText.children.iterate((function(e){e.visible=!1,e.depth=0})),bonusImage.visible=!1,bonusImage.depth=0,mns.mzk_bonusScreen.audio.stop()}function removeLife(){stopAllMusic(),vars.isPaused=!0,vars.playerIsDead=!0,mns.sfx_touchedAnEnemy.audio.play(),scene.physics.pause(),player.anims.play("tumble");let e=getClosestPlatform(),s=player.y,a=e[0]-25,t=e[1];vars.lives-=1,setTimeout((function(){vars.deathTween=scene.tweens.addCounter({from:s,to:a,ease:"Linear",duration:t,yoyo:!1}),setTimeout((function(){player.anims.play("hitFloorAfterDeath"),setTimeout((function(){vars.deathTween="",player.anims.play("turn"),player.setPosition(400,400),player.setVelocity(0,0),vars.deathResets(),resetEnemies(),vars.playerIsDead=!1,vars.isPaused=!1,scene.physics.resume(),pauseBGM(!1),!0===vars.DEBUG&&console.log("Lives left: "+vars.lives)}),1e3)}),t+10)}),1e3);let o=livesBar.children.size-1;o>=0&&(livesBar.children.getArray()[o].destroy(),vars.livesContainer.currentOffset-=vars.livesContainer.offsetX)}function setNextBomb(e){bombID=e.id;let s=e.body.x,a=e.body.y;if(23==bombID?nextBombID=0:nextBombID=bombID+1,currentMap="map"+vars.level,bombTrack=vars.bombTrack,-1==vars.currentBomb)for(vars.bombRun++,updateScore(s,a,100),updatePowerBallCounter(.5),bombNum=0;bombNum<bombTrack.length;bombNum++)bombID==bombTrack[bombNum]&&(bombNum==bombTrack.length-1?newBombIndex=0:newBombIndex=bombNum+1,vars.currentBomb=bombTrack[newBombIndex],bombs.children.iterate((function(e){e.id==vars.currentBomb&&e.anims.play("exploding",!0)})),vars.bombTrack.splice(bombNum,1),bombNum=bombTrack.length+1);else if(bombID==vars.currentBomb)for(updateScore(s,a,200),updatePowerBallCounter(1),vars.bombRun++,bombNum=0;bombNum<bombTrack.length;bombNum++)bombID==bombTrack[bombNum]&&(bombNum==bombTrack.length-1?newBombIndex=0:newBombIndex=bombNum+1,vars.currentBomb=bombTrack[newBombIndex],bombs.children.iterate((function(e){e.id==vars.currentBomb&&e.anims.play("exploding",!0)})),vars.bombTrack.splice(bombNum,1),bombNum=bombTrack.length+1);else for(updateScore(s,a,100),updatePowerBallCounter(.5),bombNum=0;bombNum<bombTrack.length;bombNum++)bombID==bombTrack[bombNum]&&(bombNum==bombTrack.length-1?newBombIndex=0:newBombIndex=bombNum+1,vars.bombTrack.splice(bombNum,1),bombNum=bombTrack.length+1)}function showBonusScore(){mns.mzk_bonusScreen.audio.play(),bonusImage.visible=!0,bonusImage.depth=1,bonusScore=getBonusScore(),bonusText.children.iterate((function(e){"bLine"==e.name&&(e.visible=!0,e.depth=2),e.name==bonusScore&&(e.visible=!0,e.depth=3),e.name=="bCount"+(vars.bombRun-1)&&(e.visible=!0,e.depth=3)})),updateScore(0,0,bonusScore,!0)}function showGameOver(){clearLevel()}function update(){if(!0===vars.vgVisible&&(vars.volumeHide-=1,vars.volumeHide<=0)){vars.vgVisible=!1,vars.volumeHide=vars.volumeHideMax;for(let e=0;e<vars.volumeGraphic.length;e++)vars.volumeGraphic[e].destroy();vars.volumeGraphic=[]}if(0==vars.showStartScreen&&0==vars.isPaused&&0==vars.levelIntroVisible){if(player.body.touching.down&&0==player.body.velocity.y?(vars.inAir=!1,selectedAnimFrame="turn"):(vars.inAir=!0,selectedAnimFrame="flyUp"),moveAndAnimateJack(selectedAnimFrame),!1===vars.enemiesCollectable&&vars.levelEnemies.length>0)for(i=0;i<vars.levelEnemies.length;i++)thisEnemy=vars.levelEnemies[i],thisEnemy.move(),null!=thisEnemy.tween&&(thisEnemy.tween.progress<1?thisEnemy.x!=thisEnemy.moveToX?thisEnemy.x=thisEnemy.enemy.x=thisEnemy.tween.getValue():thisEnemy.y=thisEnemy.enemy.y=thisEnemy.tween.getValue():(thisEnemy.tween=void 0,thisEnemy.x=thisEnemy.enemy.x=thisEnemy.moveToX,thisEnemy.y=thisEnemy.enemy.y=thisEnemy.moveToY));!0===vars.powerBallVisible&&(vars.pBLastColourChange+=1)}else{if(1==vars.animated&&(0==vars.animTimeOut?(animateLogo(),vars.animTimeOut=5):vars.animTimeOut--),0===vars.mainScreenTimer){if(vars.msLinemax>0){let e=vars.msLineCurrent,s=e+1;s>vars.msLinemax&&(s=0),e<=vars.msLinemax&&(hideMSLines(!0,e),setTimeout((function(){hideMSLines(!1,s),vars.msLineCurrent=s,vars.mainScreenTimer=vars.mainScreenTimerMax}),vars.msLineTimeouts[e]))}vars.mainScreenTimer=vars.mainScreenTimerMax}else vars.mainScreenTimer--;0==vars.gameStarted&&cursors.space.isDown&&1==vars.isPaused&&(cursors.space.isDown=!1,vars.showStartScreen=!1,vars.gameStarted=!0,initGame())}if(1==vars.levelIntroVisible&&(tweenOffset.totalProgress<1?(startLeft.setPosition(tweenOffset.getValue(),400),startRight.setPosition(800-tweenOffset.getValue(),400)):(startLeft.visible=!1,startRight.visible=!1,vars.levelIntroVisible=!1,vars.isPaused=!1,scene.input.enabled=!0,player.visible=!0,scene.physics.resume())),!0===vars.playerIsDead&&""!=vars.deathTween){let e=parseInt(vars.deathTween.getValue());player.y=e}}function updatePowerBallCounter(e=.5){if(!1===vars.powerBallVisible){let s=40-8*vars.powerBallCounter,a=88+8*vars.powerBallCounter*2;bonusBox.setCrop(s,0,a,36),vars.powerBallCounter+=e,vars.powerBallCounter>=10&&(vars.powerBallCounter-=10,spawnCollectable("P"))}}function updateScore(e,s,a,t=!1,o=!1){if(!1===t&&!1===vars.inAir&&(0===e&&console.log("Updating score but x is 0. Is this correct?"),0===s&&console.log("Updating score but y is 0. Is this correct?")),e>0&&s>0){let t=-1;switch(a){case 100:t=0;break;case 200:t=1;break;case 300:t=2;break;case 500:t=3;break;case 800:t=4;break;case 1e3:t=5;break;case 1200:t=6;break;case 2e3:t=7;break;case 3e3:t=8;break;case 5e3:t=9}if(-1!=t){let a=-1;if(vars.bonusMultiplier>1&&!1===o)switch(vars.bonusMultiplier){case 2:a=10;break;case 3:a=11;break;case 4:a=12;break;case 5:a=13}thisPopUp=scene.add.image(e,s+4,"scores",t),!1===vars.hires&&thisPopUp.setScale(vars.lowResUpScale);let r=thisPopUp.name=generateRandomID();setTimeout((function(e){thisPopUpObject=scene.children.getByName(e),thisPopUpObject.destroy()}),500,r),-1!=a&&(thisPopUp=scene.add.image(e,s+18,"scores",a),!1===vars.hires&&thisPopUp.setScale(vars.lowResUpScale),r=thisPopUp.name=generateRandomID(),setTimeout((function(e){thisPopUpObject=scene.children.getByName(e),thisPopUpObject.destroy()}),500,r))}else console.log("%cERROR: This score wasnt found... check your code! (score: "+a+")","color: red; font-weight: bold; font-size: 16px;")}let r=vars.bonusMultiplier;if(!0===t&&(r=1),vars.score+=a*r,scoreText.setText("Score: "+vars.score),fontify(vars.score.toString(),40,25,"0xffffff",!0,"scoreG",scoreGroup,!0),!1===t){if(bonusAdd=a*r,bonusAdd>5e3)for(;bonusAdd>=5e3;)bonusAdd-=5e3;if(vars.scoreSinceLast5k+=bonusAdd,vars.scoreSinceLast5k>=5e3){if(!1===o){let e=!0;for(let s=0;s<vars.levelCollectables.length;s++)"bonus"==vars.levelCollectables[s].collectableSprite&&(e=!1);!0===e&&spawnCollectable("B")}vars.scoreSinceLast5k-=5e3}}}function moveAndAnimateJack(e){0==vars.inAir?(cursors.space.isDown&&(e="flyUp"),cursors.left.isDown?(playerMove(-250),e="left"):cursors.right.isDown?(playerMove(250),e="right"):(playerMove(0),e="turn")):cursors.left.isDown?(playerMove(-250),player.body.velocity.y<0?pre="flyUp":pre="flyDown",e=pre+"Left"):cursors.right.isDown?(playerMove(250),player.body.velocity.y<0?pre="flyUp":pre="flyDown",e=pre+"Right"):(playerMove(0),e=player.body.velocity.y<0?"flyUp":"flyDown"),"undefined"!=typeof gamePad&&(gamePad.axes[0].getValue()<-.5?(playerMove(-250),e=player.body.velocity.y<0?"flyUpLeft":player.body.velocity.y>0?"flyDownLeft":"left"):gamePad.axes[0].getValue()>.5&&(playerMove(250),e=player.body.velocity.y<0?"flyUpRight":player.body.velocity.y>0?"flyDownRight":"right")),player.anims.play(e,!0)}function playerJump(e=!0){!0===vars.gameStarted&&(0==vars.inAir?(vars.inAir=!0,mns.sfx_jump.audio.play(),player.setVelocityY(-900),!0===e&&(updateScore(0,0,10),pulse())):player.setVelocityY(-20))}function playerMove(e){player.setVelocityX(e)}